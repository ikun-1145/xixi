<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="x-dns-prefetch-control" content="off">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>霜蓝的个人主页</title>
  <link rel="sitemap" type="application/xml" href="/sitemap.xml">
  <meta name="keywords" content="霜蓝,霜蓝CCC,福瑞,furry" />
  <meta name="description" content="霜蓝的个人主页，展示我的作品、联系方式和动态，欢迎访问与交流。">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }

    body.preload { visibility: hidden; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang SC",
                   "Hiragino Sans GB", "Microsoft YaHei", "Noto Sans CJK SC",
                   "Source Han Sans SC", Arial, sans-serif;
      background: linear-gradient(135deg, #dcefff, #f8fdff), url('p/bg.png') center center / cover no-repeat fixed;
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      min-height: 100vh; color: #1A1A1A;
      line-height: 1.7;
      transition: opacity 0.8s ease;
    }
    body::before {
      content: "";
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background:
        radial-gradient(circle at 20% 30%, rgba(255,255,255,0.45) 0, rgba(255,255,255,0) 60%),
        radial-gradient(circle at 80% 70%, rgba(255,255,255,0.38) 0, rgba(255,255,255,0) 60%),
        radial-gradient(circle at 40% 80%, rgba(255,255,255,0.42) 0, rgba(255,255,255,0) 60%);
      background-size: 120% 120%;
      animation: floatParticles 18s ease-in-out infinite alternate;
      pointer-events: none;
      z-index: -1;
    }

    @keyframes float {
      0% { transform: translateY(0); }
      50% { transform: translateY(-4px); }
      100% { transform: translateY(0); }
    }
    @keyframes avatarGlow {
      0% { box-shadow: 0 0 25px rgba(120, 190, 255, 0.3); }
      50% { box-shadow: 0 0 40px rgba(120, 190, 255, 0.6); }
      100% { box-shadow: 0 0 25px rgba(120, 190, 255, 0.3); }
    }

    @keyframes floatParticles {
      0% { background-position: 0% 0%; }
      100% { background-position: 100% 100%; }
    }

    @keyframes fadeInUp { from {opacity:0; transform:translateY(30px);} to {opacity:1; transform:translateY(0);} }
    @keyframes breatheGlow {
      0% { box-shadow: 0 0 12px rgba(113, 248, 252, 0.35); }
      50% { box-shadow: 0 0 22px rgba(113, 248, 252, 0.55); }
      100% { box-shadow: 0 0 12px rgba(113, 248, 252, 0.35); }
    }

    .container {
      margin-top: 2rem; padding: 2rem; width: 90%; max-width: 720px;
      background: rgba(255,255,255,0.5); 
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border-radius: 16px;
      box-shadow: 0 20px 50px rgba(80, 140, 200, 0.25), inset 0 0 40px rgba(200, 240, 255, 0.4), 0 10px 30px rgba(0,0,0,0.08); text-align: center; animation: fadeInUp 1s ease-out;
      animation: float 6s ease-in-out infinite;
      text-align: center;
    }

    .avatar { width:150px; height:150px; border-radius:50%; object-fit:cover; margin-bottom:0.5rem; box-shadow: 0 0 25px rgba(120, 190, 255, 0.6); 
    animation: float 5s ease-in-out infinite, avatarGlow 5s ease-in-out infinite;
    }
    .intro {
      font-size: 1.05rem;
      margin-top: 0.4rem;
      opacity: 0.9;
    }
    h1 { font-size:2rem; margin-bottom:1rem; }

#greeting {
  display: block;
  margin: 0.6rem auto 0.2rem;
  font-size: 2rem;
  line-height: 1.2;
  text-align: center;
  white-space: nowrap;
  overflow: hidden;
  border-right: 3px solid #71f8fc;
  
  /* 核心：动画控制打字 + 光标闪烁 */
  width: 0;
  animation: 
    typing 1.8s steps(2) forwards,          /* 2 = 你好 的字符数，时间可调 */
    blink 0.8s step-end infinite;           /* 光标一直闪 */
  
  /* 预留空间，防止挤压头像 */
  min-height: 2.6rem;
  min-width: 5ch;
}

/* 打字动画：从0宽度慢慢展开到刚好包住“你好” */
@keyframes typing {
  from { width: 0 }
  to   { width: 2.4em; }                    /* 2个中文字宽度 + 余量，视字体可调 2.2~2.6em */
}

/* 光标闪烁（更稳定版本） */
@keyframes blink {
  from, to   { border-color: transparent }
  50%        { border-color: #71f8fc; }
}

/* 可选：想打完后隐藏光标，就加这一段 */
#greeting.finished {
  border-right: none;
  animation: typing 1.8s steps(2) forwards;  /* 只保留打字动画，不闪了 */
}
    .buttons {
      display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 1rem; margin-top: 1.5rem;
    }

    .buttons a, .donate-button {
      animation: breatheGlow 4s ease-in-out infinite;
      display:inline-block; padding:0.8rem 1.5rem;
      background: #71f8fc; border-radius:30px;
      text-decoration:none; color:black; font-weight:bold; font-size:1.1rem;
      transition: transform .3s, box-shadow .3s, filter .3s; text-align:center;
    }

    .buttons a:hover, .donate-button:hover { transform:translateY(-3px); box-shadow: 0 12px 28px rgba(80, 160, 255, 0.35); filter: brightness(1.08); }

    footer { margin:2rem 0 1rem; font-size:.9rem; text-align:center; }

    #loading { position:fixed; z-index:9999; width:100%; height:100%; background:white;
      display:flex; align-items:center; justify-content:center; transition:opacity .6s; }
    .loader { border:6px solid #e0faff; border-top:6px solid #71f8fc; border-radius:50%; width:60px; height:60px; animation:spin 1s linear infinite; }
    @keyframes spin { to {transform:rotate(360deg);} }

    .modal { display:none; position:fixed; inset:0; background:rgba(0,0,0,0.5); opacity:0; transition:.4s; }
    .modal.active { display:block; opacity:1; }
    .modal-content {
      background: rgba(255,255,255,0.9); 
      backdrop-filter:blur(10px);
      -webkit-backdrop-filter: blur(10px);
      margin:15% auto; padding:2rem; width:90%; max-width:400px;
      border-radius:12px; box-shadow:0 5px 20px rgba(0,0,0,0.2); animation:modalPop .5s ease;
      text-align:center;
    }
    @keyframes modalPop { from{opacity:0;transform:scale(.8);} to{opacity:1;transform:scale(1);} }
    .close { float:right; font-size:1.5rem; cursor:pointer; }
  </style>
</head>

<body class="preload">
  <div id="loading"><div class="loader"></div></div>

  <div class="container">
    <img src="p/tx.jpeg" alt="头像" class="avatar">
    <h1 id="greeting"></h1>
    <p class="intro">欢迎来到我的个人主页，这里记录着我的创作、想法与旅程。</p>

    <div class="buttons">
      <a href="shoushe.html">兽设介绍</a>
      <a href="banquan.html">版权信息</a>
      <a href="guanzhu.html">关注我们</a>
      <a href="lianxi.html">联系我们</a>
      <a href="comment.html">评论留言</a>
      <a href="fans.html">实时粉丝数</a>
      <a href="game.html">小游戏</a>
      <button id="donateBtn" class="donate-button">捐赠支持</button>
    </div>
  </div>

  <div id="loginModal" class="modal">
    <div class="modal-content">
      <span class="close">×</span>

      <p style="margin-bottom:1rem;">请先登录后继续</p>

      <button id="githubLoginBtn" class="donate-button oauth-btn" style="width:100%; margin-bottom:0.6rem; display:flex; align-items:center; justify-content:center; gap:10px;">
        <img src="p/gh.png" alt="GitHub" style="width:22px; height:22px;">
        使用 GitHub 登录
      </button>

      <button id="googleLoginBtn" class="donate-button oauth-btn" style="width:100%; display:flex; align-items:center; justify-content:center; gap:10px;">
        <img src="p/IMG_3879.png" alt="Google" style="width:22px; height:22px;">
        使用 Google 登录
      </button>
    </div>
  </div>

  <footer>Copyright©️2024-2026霜蓝, All Rights Reserved.</footer>

  <script type="module">
    import { supabase } from './p/js/supabaseClient.js';
    
    let isLoggedIn = false;

    window.addEventListener('load', async () => {
      try {
        // 恢复本地 session（关键：保证刷新/重新进入页面仍保持登录）
        const { data: { session } } = await supabase.auth.getSession();
        isLoggedIn = !!session;

        // 监听登录状态变化（登录/退出都会更新）
        supabase.auth.onAuthStateChange((_event, session) => {
          isLoggedIn = !!session;
        });
      } catch(e){
        console.warn('Supabase 加载失败:', e);
      }

      document.getElementById('loading').style.opacity = '0';
      setTimeout(() => document.getElementById('loading').remove(), 600);

      document.body.classList.remove('preload');
      document.body.style.opacity = '1';
    });

    function closeModal(){ document.getElementById("loginModal").classList.remove("active"); }
    document.querySelector(".close").onclick = closeModal;
    document.getElementById("loginModal").onclick = (e)=>{ if(e.target===e.currentTarget) closeModal(); };

    document.getElementById("donateBtn").onclick = () => {
      if(isLoggedIn){
        document.body.style.opacity = '0';
        setTimeout(()=>location.href="donate.html",600);
      } else {
        document.getElementById("loginModal").classList.add("active");
      }
    };

    document.getElementById("githubLoginBtn").onclick = async () => {
      await supabase.auth.signInWithOAuth({
        provider:'github',
        options:{ redirectTo: location.origin + '/donate.html' }
      });
    };

    document.getElementById("googleLoginBtn").onclick = async () => {
      await supabase.auth.signInWithOAuth({
        provider:'google',
        options:{ redirectTo: location.origin + '/donate.html' }
      });
    };
  </script>

  <script>
    window.addEventListener('load', () => {
      const greetingEl = document.getElementById('greeting');
      const text = "你好";
      let index = 0;

      function typeWriter() {
        if (index < text.length) {
          greetingEl.textContent += text.charAt(index);
          index++;
          setTimeout(typeWriter, 300);
        } else {
          // 打完字后1秒隐藏光标（更自然）
          setTimeout(() => {
            greetingEl.classList.add('finished');
          }, 1000);
        }
      }

      // 稍微延迟开始打字，让页面加载更平稳
      setTimeout(typeWriter, 800);
    });
  </script>
</body>
</html>